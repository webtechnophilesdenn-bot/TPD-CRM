/*! TPDCRM 2026-01-08 */
var Espo={};window.Espo=Espo;!function(){let d=this;d.Espo||(d.Espo={});if(d.Espo.loader)throw new Error("Loader was already loaded.");let l=new class{constructor(e){this._cacheTimestamp=e||null;this._libsConfig={};this._loadCallbacks={};this._pathsBeingLoaded={};this._dataLoaded={};this._definedMap={};this._aliasMap={};this._contextId=null;this._responseCache=null;this._basePath="";this._internalModuleList=[];this._transpiledModuleList=[];this._internalModuleMap={};this._isDeveloperMode=!1;let t=window.location.origin+window.location.pathname;"/"!==t.slice(-1)&&(t=window.location.pathname.includes(".")?t.slice(0,t.lastIndexOf("/"))+"/":t+"/");this._baseUrl=t;this._isDeveloperModeIsSet=!1;this._basePathIsSet=!1;this._responseCacheIsSet=!1;this._internalModuleListIsSet=!1;this._bundleFileMap={};this._bundleMapping={};this._bundleDependenciesMap={};this._bundlePromiseMap={};this._addLibsConfigCallCount=0;this._addLibsConfigCallMaxCount=2;this._urlIdMap={}}setIsDeveloperMode(e){if(this._isDeveloperModeIsSet)throw new Error("Is-Developer-Mode is already set.");this._isDeveloperMode=e;this._isDeveloperModeIsSet=!0}setBasePath(e){if(this._basePathIsSet)throw new Error("Base path is already set.");this._basePath=e;this._basePathIsSet=!0}getCacheTimestamp(){return this._cacheTimestamp}setCacheTimestamp(e){this._cacheTimestamp=e}setResponseCache(e){if(this._responseCacheIsSet)throw new Error("Response-Cache is already set");this._responseCache=e;this._responseCacheIsSet=!0}setInternalModuleList(e){if(this._internalModuleListIsSet)throw new Error("Internal-module-list is already set");this._internalModuleList=e;this._internalModuleMap={};this._internalModuleListIsSet=!0}setTranspiledModuleList(e){this._transpiledModuleList=e}_get(e){if(e in this._definedMap)return this._definedMap[e]}_set(e,t){this._definedMap[e]=t;if("lib!"===e.slice(0,4)){var i=e.slice(4),i=this._libsConfig[i];if(i&&i.exposeAs){i=i.exposeAs;window[i]=t}}}_idToPath(e){var t,i,s,a;return-1===e.indexOf(":")?"client/lib/transpiled/src/"+e+".js":([t,i]=e.split(":"),"custom"===t?"client/custom/src/"+i+".js":(s=this._transpiledModuleList.includes(t),a=this._isModuleInternal(t),s?a?`client/lib/transpiled/modules/${t}/src/${i}.js`:`client/custom/modules/${t}/lib/transpiled/src/${i}.js`:a?"client/modules/"+t+"/src/"+i+".js":"client/custom/modules/"+t+"/src/"+i+".js"))}_executeLoadCallback(e,t){if(e in this._loadCallbacks){this._loadCallbacks[e].forEach(e=>e(t));delete this._loadCallbacks[e]}}define(i,e,s){i=i&&this._normalizeId(i);if(!i&&document.currentScript){var t=document.currentScript.src;i=this._urlIdMap[t];delete this._urlIdMap[t]}!i&&this._contextId&&(i=this._contextId);this._contextId=null;t=this._get(i);if(void 0===t)if(e){let t=e.indexOf("exports");Array.isArray(e)&&(e=e.map(e=>this._normalizeIdPath(e,i)));this.require(e,(...e)=>{this._defineProceed(s,i,e,t)})}else this._defineProceed(s,i,[],-1)}_defineProceed(e,t,i,s){let a=e.apply(d,i);if(void 0===a&&-1===s&&t)throw new Error(`Could not load '${t}'.`);if(-1!==s){var n=i[s];a="default"in n?n.default:n}if(t){this._set(t,a);this._executeLoadCallback(t,a)}else console.warn("Lib without id.")}require(e,l,t){let o;if("[object Array]"===Object.prototype.toString.call(e)){o=e;o.forEach((e,t)=>{o[t]=this._normalizeId(e)})}else if(e){e=this._normalizeId(e);o=[e]}else o=[];let r=o.length;if(1===r)this._load(o[0],l,t);else if(r){let a=0,n={};o.forEach(s=>{this._load(s,e=>{n[s]=e;a++;if(a===r){var t,i=[];for(t in o)i.push(n[o[t]]);l.apply(d,i)}})})}else l.apply(d)}_convertCamelCaseToHyphen(e){return null===e?e:e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}_normalizeIdPath(e,t){if("."!==e.charAt(0))return e;if("./"!==e.slice(0,2)&&"../"!==e.slice(0,3))return e;let i=e;var s,a=t.split("/").slice(0,-1),n=("./"===e.slice(0,2)&&(i=a.join("/")+"/"+e.slice(2)),i.split("/"));let l=0;for(s of n){if(".."!==s)break;l++}l&&(i=a.slice(0,-l).join("/")+"/"+i.slice(3*l));return i}_restoreId(e){var t,i;return e.includes(":")?([t,i]=e.split(":"),`modules/${t}/`+i):e}_normalizeId(e){e in this._aliasMap&&(e=this._aliasMap[e]);~e.indexOf(".")&&!~e.indexOf("!")&&".js"!==e.slice(-3)&&console.warn(e+": module ID should use slashes instead of dots and hyphen instead of CamelCase.");if(/[A-Z]/.exec(e[0]))return-1!==e.indexOf(":")?(i=e.split(":"),t=i[0],i=i[1],this._convertCamelCaseToHyphen(t)+":"+this._convertCamelCaseToHyphen(i).split(".").join("/")):this._convertCamelCaseToHyphen(e).split(".").join("/");if(e.startsWith("modules/")){e=e.slice(8);var t=e.indexOf("/");if(0<t){var i=e.slice(0,t);e=e.slice(t+1);return i+":"+e}}return e}_addLoadCallback(e,t){e in this._loadCallbacks||(this._loadCallbacks[e]=[]);this._loadCallbacks[e].push(t)}_load(o,r,e){if("exports"===o)r({});else{let i,a,n,s,l,t=o;if(0===o.indexOf("lib!")){i="script";a="lib";t=o.slice(4);n=t;s="window";l=null;var d=t in this._libsConfig;if(d){var h=this._libsConfig[t]||{};n=h.path||n;this._isDeveloperMode&&h.devPath&&(n=h.devPath);s=h.exportsTo||null;l=h.exportsAs||null}d&&!s&&(a="amd");if(-1!==n.indexOf(":"))throw console.error(`Not allowed path '${n}'.`),new Error;let e=void 0;s&&l&&(e=this._fetchObject(s,l));void 0===e&&o in this._definedMap&&(e=this._definedMap[o]);if(void 0!==e)return r(e),void 0}else if(0===o.indexOf("res!")){i="text";a="res";t=o.slice(4);n=t;if(-1!==n.indexOf(":"))throw console.error(`Not allowed path '${n}'.`),new Error}else{i="script";a="amd";if(!o||""===o)throw new Error("Can't load with empty module ID.");h=this._get(o);if(void 0!==h)return r(h),void 0;let s=this._restoreId(o);if(s in this._bundleMapping){let i=this._bundleMapping[s];this._requireBundle(i).then(()=>{var e=this._get(o);if(void 0===e){var t=`Could not obtain module '${s}' from bundle '${i}'.`;console.error(t);throw new Error(t)}r(e)});return}n=this._idToPath(o)}if(o in this._dataLoaded)r(this._dataLoaded[o]);else{let t={id:o,type:a,dataType:i,path:n,callback:r,errorCallback:e,exportsAs:l,exportsTo:s};if(n in this._pathsBeingLoaded)this._addLoadCallback(o,r);else{this._pathsBeingLoaded[n]=!0;let e=!1;if(this._cacheTimestamp){e=!0;d=-1<n.indexOf("?")?"&":"?";n+=d+"r="+this._cacheTimestamp}h=this._basePath+n;t.path=n;t.url=h;t.useCache=e;if("script"===t.dataType){this._addLoadCallback(o,r);d=new URL(this._baseUrl+h),d=(e||d.searchParams.append("_",Date.now().toString()),d.toString());"amd"===a&&(this._urlIdMap[d]=o);this._addScript(d,()=>{let e;if("amd"===a)return e=this._get(o),void 0===e?void 0:void this._executeLoadCallback(o,e);if(s&&l){e=this._fetchObject(s,l);this._dataLoaded[o]=e;this._executeLoadCallback(o,e)}else if("lib"===a){this._dataLoaded[o]=void 0;this._executeLoadCallback(o,void 0)}else console.warn(`Could not obtain ${o}.`)})}else this._responseCache?this._responseCache.match(new Request(h)).then(e=>{e?e.text().then(e=>this._handleResponseText(t,e)):this._processRequest(t)}):this._processRequest(t)}}}}_addScript(t,e){var i=document.createElement("script");i.src=t;i.async=!0;i.addEventListener("error",e=>{console.error(`Could not load script '${t}'.`,e)});document.head.appendChild(i);i.addEventListener("load",()=>e())}_requireBundle(s){if(!this._bundlePromiseMap[s]){let i=this._bundleDependenciesMap[s]||[];i.length?this._bundlePromiseMap[s]=new Promise(e=>{var t=i.map(e=>0===e.indexOf("bundle!")?this._requireBundle(e.substring(7)):Espo.loader.requirePromise(e));Promise.all(t).then(()=>this._addBundle(s)).then(()=>e())}):this._bundlePromiseMap[s]=this._addBundle(s)}return this._bundlePromiseMap[s]}_addBundle(t){let e=this._bundleFileMap[t];if(!e)throw new Error(`Unknown bundle '${t}'.`);if(this._cacheTimestamp){var i=-1<e.indexOf("?")?"&":"?";e+=i+"r="+this._cacheTimestamp}e=this._basePath+e;let s=document.createElement("script");s.src=e;s.async=!0;s.addEventListener("error",e=>{console.error(`Could not load bundle '${t}'.`,e)});return new Promise(e=>{document.head.appendChild(s);s.addEventListener("load",()=>e())})}_fetchObject(e,t){let i=d;if("window"===e)i=d;else for(var s of e.split(".")){i=i[s];if(void 0===i)return}if(t in i)return i[t]}_processRequest(t){let i=t.url,s=t.errorCallback,a=t.path;var e=t.useCache,n=new URL(this._baseUrl+i);e||n.searchParams.append("_",Date.now().toString());fetch(n).then(e=>{if(e.ok)e.text().then(e=>{this._responseCache&&this._responseCache.put(i,new Response(e));this._handleResponseText(t,e)});else{if("function"!=typeof s)throw new Error(`Could not fetch asset '${a}'.`);s()}}).catch(()=>{if("function"!=typeof s)throw new Error(`Could not fetch asset '${a}'.`);s()})}_handleResponseText(e,t){var i=e.id,s=e.callback;this._addLoadCallback(i,s);this._dataLoaded[i]=t;this._executeLoadCallback(i,t)}addLibsConfig(e){if(this._addLibsConfigCallCount===this._addLibsConfigCallMaxCount)throw new Error("Not allowed to call addLibsConfig.");this._addLibsConfigCallCount++;this._libsConfig={...this._libsConfig,...e}}setAliasMap(e){this._aliasMap=e}_isModuleInternal(e){e in this._internalModuleMap||(this._internalModuleMap[e]=-1!==this._internalModuleList.indexOf(e));return this._internalModuleMap[e]}mapBundleFile(e,t){this._bundleFileMap[e]=t}mapBundleDependencies(e,t){this._bundleDependenciesMap[e]=t}addBundleMapping(e){Object.assign(this._bundleMapping,e)}setContextId(e){this._contextId=e}requirePromise(i){return new Promise((t,e)=>{this.require(i,e=>t(e),()=>e())})}};Espo.loader={setIsDeveloperMode:function(e){l.setIsDeveloperMode(e)},setBasePath:function(e){l.setBasePath(e)},getCacheTimestamp:function(){return l.getCacheTimestamp()},setCacheTimestamp:function(e){l.setCacheTimestamp(e)},setResponseCache:function(e){l.setResponseCache(e)},define:function(e,t,i){l.define(e,t,i)},require:function(e,t,i){l.require(e,t,i)},requirePromise:function(e){return l.requirePromise(e)},addLibsConfig:function(e){l.addLibsConfig(e)},mapBundleFile:function(e,t){l.mapBundleFile(e,t)},mapBundleDependencies:function(e,t){l.mapBundleDependencies(e,t)},addBundleMapping:function(e){l.addBundleMapping(e)},setContextId:function(e){l.setContextId(e)}};d.require=Espo.require=function(e,t,i,s){i&&(t=t.bind(i));l.require(e,t,s)};d.define=Espo.define=function(e,t,i){let s=null,a=null,n;if("function"==typeof e)n=e;else if(void 0!==e&&"function"==typeof t){if(Array.isArray(e))a=e;else{s=e;a=[]}n=t}else{s=e;a=t;n=i}l.define(s,a,n)};d.define.amd=!0;var e=document.querySelector('script[data-name="loader-params"]');if(e){e=JSON.parse(e.textContent);l.setCacheTimestamp(e.cacheTimestamp);l.setBasePath(e.basePath);l.setInternalModuleList(e.internalModuleList);l.setTranspiledModuleList(e.transpiledModuleList);l.addLibsConfig(e.libsConfig);l.setAliasMap(e.aliasMap)}}.call(window);
//# sourceMappingURL=espo.js.map