<?php

use Illuminate\Support\Facades\Route;
use App\Http\Controllers\ContactController;
use App\Http\Controllers\Admin\BlogController as AdminBlogController;
use App\Http\Controllers\BlogController as PublicBlogController;
use App\Http\Controllers\Admin\AdminController;
use App\Http\Controllers\Admin\BlogController;
use App\Http\Controllers\ChatbotController;

// ================= CASE STUDIES CONTROLLERS =================
use App\Http\Controllers\CaseStudyController;
use App\Http\Controllers\Admin\CaseStudyController as AdminCaseStudyController;

// ================= ADMIN LOGIN ROUTES =================
// Show login form
Route::get('/admin/login', [AdminController::class, 'showLoginForm'])->name('admin.login');

// Handle login submission
Route::post('/admin/login', [AdminController::class, 'login'])->name('admin.login.submit');

// ================= PROTECTED ADMIN ROUTES =================
Route::middleware('admin.auth')->prefix('admin')->group(function () {
    
    // ----- Blogs Management -----
    Route::get('/blogs', [BlogController::class, 'index'])->name('admin.blogs.index');
    Route::get('/blogs/create', [BlogController::class, 'create'])->name('admin.blogs.create');
    Route::post('/blogs', [BlogController::class, 'store'])->name('admin.blogs.store');
    Route::get('/blogs/{blog}/edit', [BlogController::class, 'edit'])->name('admin.blogs.edit');
    Route::put('/blogs/{blog}', [BlogController::class, 'update'])->name('admin.blogs.update');
    Route::delete('/blogs/{blog}', [BlogController::class, 'destroy'])->name('admin.blogs.destroy');
    
    // ----- Case Studies Management (CRUD) -----
    Route::get('/case-studies', [AdminCaseStudyController::class, 'index'])->name('admin.case-studies.index');
    Route::get('/case-studies/create', [AdminCaseStudyController::class, 'create'])->name('admin.case-studies.create');
    Route::post('/case-studies', [AdminCaseStudyController::class, 'store'])->name('admin.case-studies.store');
    Route::get('/case-studies/{caseStudy}/edit', [AdminCaseStudyController::class, 'edit'])->name('admin.case-studies.edit');
    Route::put('/case-studies/{caseStudy}', [AdminCaseStudyController::class, 'update'])->name('admin.case-studies.update');
    Route::delete('/case-studies/{caseStudy}', [AdminCaseStudyController::class, 'destroy'])->name('admin.case-studies.destroy');
    
    // ----- Logout -----
    Route::post('/logout', [AdminController::class, 'logout'])->name('admin.logout');
});

// ================= PUBLIC BLOG ROUTES =================
Route::get('/blogs', [PublicBlogController::class, 'index'])->name('blogs.index');
Route::get('/blogs/{slug}', [PublicBlogController::class, 'show'])->name('blogs.show');

// ================= PUBLIC CASE STUDIES ROUTES =================
// Frontend case studies page (dynamic from database)
Route::get('/case-studies', [CaseStudyController::class, 'index'])->name('case-studies.index');

// Optional: API endpoint for case studies JSON
Route::get('/api/case-studies', [CaseStudyController::class, 'api'])->name('api.case-studies');

// ================= CHATBOT API ROUTE =================
Route::post('/api/chatbot', [ChatbotController::class, 'chat'])->name('api.chatbot');

// ================= STATIC PAGES =================
Route::view('/', 'home')->name('home');
Route::view('/about', 'about')->name('about');
Route::view('/models', 'models')->name('models');
Route::view('/services', 'services')->name('services');

// ================= CONTACT ROUTES =================
Route::get('/contact', [ContactController::class, 'show'])->name('contact.show');
Route::post('/contact', [ContactController::class, 'submit'])->name('contact.submit');

// ================= PRODUCTS ROUTES =================
Route::prefix('products')->name('products.')->group(function () {
    Route::view('/crm', 'products.crm')->name('crm');
    Route::view('/hrms', 'products.hrms')->name('hrms');
    Route::view('/monitoring-tool', 'products.monitoring-tool')->name('monitor');
    Route::view('/chatbot', 'products.chatbot')->name('chatbot');
});

// ================= SERVICES ROUTES =================
Route::prefix('services')->name('services.')->group(function () {

    // ----- Digital Marketing -----
    Route::prefix('digital-marketing')->name('digital-marketing.')->group(function () {
        Route::view('/seo', 'services.seo')->name('seo');
        Route::view('/sem', 'services.sem')->name('sem');
        Route::view('/smm', 'services.smm')->name('smm');
        Route::view('/content-marketing', 'services.content-marketing')->name('content-marketing');
        Route::view('/email-marketing', 'services.email-marketing')->name('email-marketing');
        Route::view('/affiliate-marketing', 'services.affiliate-marketing')->name('affiliate-marketing');
        Route::view('/influencer-marketing', 'services.influencer-marketing')->name('influencer-marketing');
        Route::view('/marketing-automation', 'services.marketing-automation')->name('marketing-automation');
    });

    // ----- Multicloud -----
    Route::prefix('multicloud')->name('multicloud.')->group(function () {
        Route::view('/aws', 'services.aws')->name('aws');
        Route::view('/azure', 'services.azure')->name('azure');
        Route::view('/gcp', 'services.gcp')->name('gcp');
    });

    // ----- Development -----
    Route::prefix('development')->name('development.')->group(function () {
        Route::view('/software', 'services.software')->name('software');
        Route::view('/mobile', 'services.mobile')->name('mobile');
    });

    // ----- Single Services -----
    Route::view('/cyber-security', 'services.cyber-security')->name('cyber-security');
    Route::view('/blockchain', 'services.blockchain')->name('blockchain');
    Route::view('/ai-ml-devops', 'services.ai-ml-devops')->name('ai-ml-devops');
    Route::view('/data-science', 'services.data-science')->name('data-science');

    // ----- Others -----
    Route::prefix('others')->name('others.')->group(function () {
        Route::view('/staff-augmentation', 'services.staff-augmentation')->name('staff-augmentation');
        Route::view('/remote-infrastructure', 'services.remote-infrastructure')->name('remote-infrastructure');
    });
});

// ================= SEO MIDDLEWARE TEST ROUTES =================
Route::get('/seo-check', function () {
    return response('<!DOCTYPE html>
    <html>
    <head>
        <title>SEO Check Page - Technophiles Den</title>
        <meta name="description" content="Checking SEO middleware implementation for Technophiles Den">
    </head>
    <body>
        <main>
            <h1>SEO Implementation Test</h1>
            <img src="/images/og-default.jpg">
            <img src="https://picsum.photos/400/300">
            <p>View page source to check SEO tags.</p>
        </main>
    </body>
    </html>')->header('Content-Type', 'text/html');
});
// Test route without explicit middleware
Route::get('/test-middleware-debug', function () {
    return response('<html><head><title>Test</title></head><body><h1>Test</h1></body></html>')
        ->header('Content-Type', 'text/html');
});